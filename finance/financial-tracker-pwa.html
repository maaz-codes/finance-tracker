
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Financial Tracker</title>
    
    <!-- PWA Meta Tags -->
    <meta name="theme-color" content="#3B82F6">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Financial Tracker">
    <meta name="mobile-web-app-capable" content="yes">
    
    <!-- Favicon and App Icons -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%233B82F6'%3E%3Cpath d='M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z'/%3E%3C/svg%3E">
    <link rel="apple-touch-icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%233B82F6'%3E%3Cpath d='M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z'/%3E%3C/svg%3E">
    
    <!-- Manifest -->
    <link rel="manifest" href="data:application/json;charset=utf-8,%7B%22name%22%3A%22Financial%20Tracker%22%2C%22short_name%22%3A%22Budget%22%2C%22start_url%22%3A%22.%22%2C%22display%22%3A%22standalone%22%2C%22background_color%22%3A%22%23ffffff%22%2C%22theme_color%22%3A%22%233B82F6%22%2C%22icons%22%3A%5B%7B%22src%22%3A%22data%3Aimage/svg%2Bxml%2C%253Csvg%2520xmlns%3D%27http%3A//www.w3.org/2000/svg%27%2520viewBox%3D%270%25200%252024%252024%27%2520fill%3D%27%25233B82F6%27%253E%253Cpath%2520d%3D%27M12%25202C6.48%25202%25202%25206.48%25202%252012s4.48%252010%252010%252010%252010-4.48%252010-10S17.52%25202%252012%25202zm-2%252015l-5-5%25201.41-1.41L10%252014.17l7.59-7.59L19%25208l-9%25209z%27/%253E%253C/svg%253E%22%2C%22sizes%22%3A%22192x192%22%2C%22type%22%3A%22image/svg%2Bxml%22%7D%2C%7B%22src%22%3A%22data%3Aimage/svg%2Bxml%2C%253Csvg%2520xmlns%3D%27http%3A//www.w3.org/2000/svg%27%2520viewBox%3D%270%25200%252024%252024%27%2520fill%3D%27%25233B82F6%27%253E%253Cpath%2520d%3D%27M12%25202C6.48%25202%25202%25206.48%25202%252012s4.48%252010%252010%252010%252010-4.48%252010-10S17.52%25202%252012%25202zm-2%252015l-5-5%25201.41-1.41L10%252014.17l7.59-7.59L19%25208l-9%25209z%27/%253E%253C/svg%253E%22%2C%22sizes%22%3A%22512x512%22%2C%22type%22%3A%22image/svg%2Bxml%22%7D%5D%7D">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background-color: #f9fafb;
            line-height: 1.6;
            -webkit-font-smoothing: antialiased;
        }
        
        .app {
            min-height: 100vh;
            padding: 16px;
            max-width: 448px;
            margin: 0 auto;
        }
        
        .card {
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #3B82F6, #8B5CF6);
            color: white;
            padding: 24px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 8px;
        }
        
        .balance {
            font-size: 36px;
            font-weight: bold;
            margin-bottom: 16px;
        }
        
        .add-money-btn {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            padding: 8px 16px;
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.2s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }
        
        .add-money-btn:hover {
            background: rgba(255, 255, 255, 0.3);
        }
        
        .content {
            padding: 24px;
        }
        
        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }
        
        .section-title {
            font-size: 20px;
            font-weight: 600;
            color: #1f2937;
        }
        
        .btn {
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
            font-weight: 500;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            text-decoration: none;
        }
        
        .btn-primary {
            background: #3B82F6;
            color: white;
            padding: 8px;
        }
        
        .btn-primary:hover {
            background: #2563EB;
        }
        
        .btn-red {
            background: #EF4444;
            color: white;
            padding: 12px 16px;
            width: 100%;
            justify-content: center;
        }
        
        .btn-red:hover {
            background: #DC2626;
        }
        
        .btn-red:disabled {
            background: #D1D5DB;
            cursor: not-allowed;
        }
        
        .btn-gray {
            background: #6B7280;
            color: white;
            padding: 8px 16px;
            width: 100%;
            justify-content: center;
        }
        
        .btn-gray:hover {
            background: #4B5563;
        }
        
        .category-card {
            background: #f9fafb;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            padding: 16px;
            margin-bottom: 12px;
        }
        
        .category-header {
            display: flex;
            justify-content: space-between;
            align-items: start;
            margin-bottom: 8px;
        }
        
        .category-name {
            font-weight: 600;
            color: #1f2937;
        }
        
        .category-actions {
            display: flex;
            gap: 4px;
        }
        
        .icon-btn {
            background: none;
            border: none;
            color: #6b7280;
            cursor: pointer;
            padding: 4px;
            border-radius: 4px;
            transition: color 0.2s;
        }
        
        .icon-btn:hover {
            color: #3B82F6;
        }
        
        .icon-btn.delete:hover {
            color: #EF4444;
        }
        
        .available-amount {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 4px;
        }
        
        .available-amount.positive {
            color: #10B981;
        }
        
        .available-amount.negative {
            color: #EF4444;
        }
        
        .available-label {
            font-size: 14px;
            color: #6b7280;
            margin-bottom: 8px;
        }
        
        .monthly-budget {
            font-size: 14px;
            color: #6b7280;
        }
        
        .edit-form {
            display: flex;
            gap: 8px;
            margin-top: 8px;
        }
        
        .edit-form input {
            flex: 1;
            padding: 4px 8px;
            border: 1px solid #d1d5db;
            border-radius: 4px;
            font-size: 14px;
        }
        
        .edit-form button {
            background: #10B981;
            color: white;
            border: none;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 14px;
            cursor: pointer;
        }
        
        .empty-state {
            text-align: center;
            padding: 32px 0;
            color: #6b7280;
        }
        
        .actions {
            padding: 0 24px 24px;
        }
        
        .actions .btn {
            margin-bottom: 12px;
        }
        
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 16px;
            z-index: 1000;
        }
        
        .modal {
            background: white;
            border-radius: 12px;
            padding: 24px;
            width: 100%;
            max-width: 400px;
        }
        
        .modal h3 {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 16px;
        }
        
        .form-group {
            margin-bottom: 12px;
        }
        
        .form-group input,
        .form-group select {
            width: 100%;
            padding: 12px 16px;
            border: 1px solid #d1d5db;
            border-radius: 8px;
            font-size: 16px;
        }
        
        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: #3B82F6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }
        
        .modal-actions {
            display: flex;
            gap: 12px;
            margin-top: 16px;
        }
        
        .btn-cancel {
            flex: 1;
            background: #d1d5db;
            color: #374151;
            padding: 8px 16px;
            text-align: center;
        }
        
        .btn-cancel:hover {
            background: #9ca3af;
        }
        
        .btn-confirm {
            flex: 1;
            padding: 8px 16px;
            text-align: center;
        }
        
        .btn-green {
            background: #10B981;
            color: white;
        }
        
        .btn-green:hover {
            background: #059669;
        }
        
        .history {
            border-top: 1px solid #e5e7eb;
            background: #f9fafb;
        }
        
        .history-content {
            padding: 16px;
        }
        
        .history-title {
            font-weight: 600;
            margin-bottom: 12px;
            color: #1f2937;
        }
        
        .history-list {
            max-height: 256px;
            overflow-y: auto;
        }
        
        .history-item {
            background: white;
            padding: 12px;
            border-radius: 6px;
            border: 1px solid #e5e7eb;
            margin-bottom: 8px;
            font-size: 14px;
        }
        
        .history-item-header {
            display: flex;
            justify-content: space-between;
            align-items: start;
        }
        
        .history-amount {
            font-weight: 600;
            color: #EF4444;
        }
        
        .history-category {
            color: #6b7280;
        }
        
        .history-note {
            color: #6b7280;
            font-size: 12px;
            margin-top: 4px;
        }
        
        .history-date {
            color: #9ca3af;
            font-size: 12px;
            text-align: right;
        }
        
        .history-empty {
            text-align: center;
            padding: 16px 0;
            color: #6b7280;
        }
        
        /* Icons */
        .icon {
            width: 16px;
            height: 16px;
            stroke: currentColor;
            fill: none;
            stroke-width: 2;
        }
        
        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <div id="app" class="app">
        <div class="card">
            <!-- Header -->
            <div class="header">
                <h1>Total Balance</h1>
                <div class="balance" id="totalBalance">$0.00</div>
                <button class="add-money-btn" onclick="showAddMoney()">
                    <svg class="icon" viewBox="0 0 24 24"><path d="m12 5 0 14m-7-7 14 0"/></svg>
                    Add Money
                </button>
            </div>
            
            <!-- Categories -->
            <div class="content">
                <div class="section-header">
                    <h2 class="section-title">Categories</h2>
                    <button class="btn btn-primary" onclick="showAddCategory()">
                        <svg class="icon" viewBox="0 0 24 24"><path d="m12 5 0 14m-7-7 14 0"/></svg>
                    </button>
                </div>
                
                <div id="categoriesList"></div>
            </div>
            
            <!-- Actions -->
            <div class="actions">
                <button class="btn btn-red" id="logExpenseBtn" onclick="showExpenseModal()">
                    <svg class="icon" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/><path d="M12 6v6l4 2"/></svg>
                    Log Expense
                </button>
                
                <button class="btn btn-gray" onclick="toggleHistory()">
                    <svg class="icon" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/><polyline points="12,6 12,12 16,14"/></svg>
                    <span id="historyToggleText">Show History (0)</span>
                </button>
            </div>
            
            <!-- History -->
            <div id="historySection" class="history hidden">
                <div class="history-content">
                    <h3 class="history-title">Recent Expenses</h3>
                    <div id="historyList"></div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Modals -->
    <div id="addMoneyModal" class="modal-overlay hidden">
        <div class="modal">
            <h3>Add Money</h3>
            <div class="form-group">
                <input type="number" id="addMoneyAmount" placeholder="Enter amount" step="0.01">
            </div>
            <div class="modal-actions">
                <button class="btn btn-cancel" onclick="hideAddMoney()">Cancel</button>
                <button class="btn btn-confirm btn-green" onclick="addMoney()">Add Money</button>
            </div>
        </div>
    </div>
    
    <div id="addCategoryModal" class="modal-overlay hidden">
        <div class="modal">
            <h3>Create Category</h3>
            <div class="form-group">
                <input type="text" id="categoryName" placeholder="Category name">
            </div>
            <div class="form-group">
                <input type="number" id="categoryBudget" placeholder="Monthly budget" step="0.01">
            </div>
            <div class="modal-actions">
                <button class="btn btn-cancel" onclick="hideAddCategory()">Cancel</button>
                <button class="btn btn-confirm btn-primary" onclick="createCategory()">Create</button>
            </div>
        </div>
    </div>
    
    <div id="expenseModal" class="modal-overlay hidden">
        <div class="modal">
            <h3>Log Expense</h3>
            <div class="form-group">
                <input type="number" id="expenseAmount" placeholder="Amount" step="0.01">
            </div>
            <div class="form-group">
                <select id="expenseCategory">
                    <option value="">Select category</option>
                </select>
            </div>
            <div class="form-group">
                <input type="text" id="expenseNote" placeholder="Note (optional)">
            </div>
            <div class="modal-actions">
                <button class="btn btn-cancel" onclick="hideExpenseModal()">Cancel</button>
                <button class="btn btn-confirm btn-red" onclick="logExpense()">Log Expense</button>
            </div>
        </div>
    </div>

    <script>
        // App State
        let appData = {
            totalBalance: 0,
            categories: [],
            expenses: []
        };
        
        let editingCategoryId = null;
        let historyVisible = false;
        
        // Initialize App
        function init() {
            loadData();
            render();
            
            // Register service worker for PWA
            if ('serviceWorker' in navigator) {
                navigator.serviceWorker.register('data:text/javascript,console.log("SW registered")');
            }
        }
        
        // Data Management
        function loadData() {
            const saved = localStorage.getItem('financialTrackerData');
            if (saved) {
                appData = JSON.parse(saved);
            }
        }
        
        function saveData() {
            localStorage.setItem('financialTrackerData', JSON.stringify(appData));
        }
        
        // Calculations
        function getDaysInMonth() {
            const now = new Date();
            return new Date(now.getFullYear(), now.getMonth() + 1, 0).getDate();
        }
        
        function calculateAvailableToday(category) {
            const daysInMonth = getDaysInMonth();
            const dailyAmount = category.monthlyBudget / daysInMonth;
            
            const categoryExpenses = appData.expenses.filter(expense => expense.categoryId === category.id);
            
            const expensesByDay = {};
            categoryExpenses.forEach(expense => {
                const expenseDate = new Date(expense.timestamp);
                const dayKey = expenseDate.toDateString();
                if (!expensesByDay[dayKey]) {
                    expensesByDay[dayKey] = 0;
                }
                expensesByDay[dayKey] += expense.amount;
            });
            
            const categoryCreatedDate = new Date(category.createdDate);
            const today = new Date();
            let totalRollover = 0;
            
            for (let d = new Date(categoryCreatedDate); d < today; d.setDate(d.getDate() + 1)) {
                const dayKey = d.toDateString();
                const spentThisDay = expensesByDay[dayKey] || 0;
                const rolloverForDay = dailyAmount - spentThisDay;
                totalRollover += rolloverForDay;
            }
            
            return dailyAmount + totalRollover;
        }
        
        function formatCurrency(amount) {
            return new Intl.NumberFormat('en-US', {
                style: 'currency',
                currency: 'USD'
            }).format(amount);
        }
        
        // UI Updates
        function render() {
            updateBalance();
            updateCategories();
            updateHistory();
            updateExpenseButton();
        }
        
        function updateBalance() {
            document.getElementById('totalBalance').textContent = formatCurrency(appData.totalBalance);
        }
        
        function updateCategories() {
            const container = document.getElementById('categoriesList');
            
            if (appData.categories.length === 0) {
                container.innerHTML = '<div class="empty-state">No categories yet. Create your first category to start tracking!</div>';
                return;
            }
            
            container.innerHTML = appData.categories.map(category => {
                const availableToday = calculateAvailableToday(category);
                const isNegative = availableToday < 0;
                
                return `
                    <div class="category-card">
                        <div class="category-header">
                            <h3 class="category-name">${category.name}</h3>
                            <div class="category-actions">
                                <button class="icon-btn" onclick="startEditCategory('${category.id}')">
                                    <svg class="icon" viewBox="0 0 24 24"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/><path d="m18.5 2.5 3 3L12 15l-4 1 1-4 9.5-9.5z"/></svg>
                                </button>
                                <button class="icon-btn delete" onclick="deleteCategory('${category.id}')">
                                    <svg class="icon" viewBox="0 0 24 24"><path d="m3 6 18 0"/><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6m3 0V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"/></svg>
                                </button>
                            </div>
                        </div>
                        
                        <div class="available-amount ${isNegative ? 'negative' : 'positive'}">
                            ${formatCurrency(availableToday)}
                        </div>
                        <div class="available-label">Available today</div>
                        
                        ${editingCategoryId === category.id ? `
                            <div class="edit-form">
                                <input type="number" id="editBudget" value="${category.monthlyBudget}" step="0.01">
                                <button onclick="saveEditCategory('${category.id}')">Save</button>
                            </div>
                        ` : `
                            <div class="monthly-budget">Monthly budget: ${formatCurrency(category.monthlyBudget)}</div>
                        `}
                    </div>
                `;
            }).join('');
        }
        
        function updateHistory() {
            const container = document.getElementById('historyList');
            const toggleText = document.getElementById('historyToggleText');
            
            toggleText.textContent = `${historyVisible ? 'Hide' : 'Show'} History (${appData.expenses.length})`;
            
            if (appData.expenses.length === 0) {
                container.innerHTML = '<div class="history-empty">No expenses logged yet</div>';
                return;
            }
            
            const sortedExpenses = [...appData.expenses].sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));
            
            container.innerHTML = sortedExpenses.map(expense => {
                const category = appData.categories.find(cat => cat.id === expense.categoryId);
                const date = new Date(expense.timestamp);
                
                return `
                    <div class="history-item">
                        <div class="history-item-header">
                            <div>
                                <div class="history-amount">-${formatCurrency(expense.amount)}</div>
                                <div class="history-category">${category?.name || 'Unknown Category'}</div>
                                ${expense.note ? `<div class="history-note">${expense.note}</div>` : ''}
                            </div>
                            <div class="history-date">
                                <div>${date.toLocaleDateString()}</div>
                                <div>${date.toLocaleTimeString()}</div>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }
        
        function updateExpenseButton() {
            const btn = document.getElementById('logExpenseBtn');
            btn.disabled = appData.categories.length === 0;
        }
        
        // Modal Functions
        function showAddMoney() {
            document.getElementById('addMoneyModal').classList.remove('hidden');
            document.getElementById('addMoneyAmount').focus();
        }
        
        function hideAddMoney() {
            document.getElementById('addMoneyModal').classList.add('hidden');
            document.getElementById('addMoneyAmount').value = '';
        }
        
        function addMoney() {
            const amount = parseFloat(document.getElementById('addMoneyAmount').value);
            if (amount && amount > 0) {
                appData.totalBalance += amount;
                saveData();
                render();
                hideAddMoney();
            }
        }
        
        function showAddCategory() {
            document.getElementById('addCategoryModal').classList.remove('hidden');
            document.getElementById('categoryName').focus();
        }
        
        function hideAddCategory() {
            document.getElementById('addCategoryModal').classList.add('hidden');
            document.getElementById('categoryName').value = '';
            document.getElementById('categoryBudget').value = '';
        }
        
        function createCategory() {
            const name = document.getElementById('categoryName').value;
            const budget = parseFloat(document.getElementById('categoryBudget').value);
            
            if (name && budget) {
                const category = {
                    id: Date.now().toString(),
                    name: name,
                    monthlyBudget: budget,
                    createdDate: new Date().toISOString()
                };
                
                appData.categories.push(category);
                saveData();
                render();
                updateExpenseCategories();
                hideAddCategory();
            }
        }
        
        function showExpenseModal() {
            if (appData.categories.length === 0) return;
            
            updateExpenseCategories();
            document.getElementById('expenseModal').classList.remove('hidden');
            document.getElementById('expenseAmount').focus();
        }
        
        function hideExpenseModal() {
            document.getElementById('expenseModal').classList.add('hidden');
            document.getElementById('expenseAmount').value = '';
            document.getElementById('expenseCategory').value = '';
            document.getElementById('expenseNote').value = '';
        }
        
        function updateExpenseCategories() {
            const select = document.getElementById('expenseCategory');
            select.innerHTML = '<option value="">Select category</option>' +
                appData.categories.map(cat => `<option value="${cat.id}">${cat.name}</option>`).join('');
        }
        
        function logExpense() {
            const amount = parseFloat(document.getElementById('expenseAmount').value);
            const categoryId = document.getElementById('expenseCategory').value;
            const note = document.getElementById('expenseNote').value;
            
            if (amount && categoryId) {
                const expense = {
                    id: Date.now().toString(),
                    amount: amount,
                    categoryId: categoryId,
                    note: note,
                    timestamp: new Date().toISOString()
                };
                
                appData.totalBalance -= amount;
                appData.expenses.push(expense);
                saveData();
                render();
                hideExpenseModal();
            }
        }
        
        // Category Management
        function startEditCategory(categoryId) {
            editingCategoryId = categoryId;
            render();
            setTimeout(() => {
                const input = document.getElementById('editBudget');
                if (input) input.focus();
            }, 0);
        }
        
        function saveEditCategory(categoryId) {
            const newBudget = parseFloat(document.getElementById('editBudget').value);
            if (newBudget) {
                const category = appData.categories.find(cat => cat.id === categoryId);
                if (category) {
                    category.monthlyBudget = newBudget;
                    saveData();
                }
            }
            editingCategoryId = null;
            render();
        }
        
        function deleteCategory(categoryId) {
            if (confirm('Are you sure you want to delete this category? This action cannot be undone.')) {
                appData.categories = appData.categories.filter(cat => cat.id !== categoryId);
                saveData();
                render();
                updateExpenseCategories();
            }
        }
        
        // History Toggle
        function toggleHistory() {
            historyVisible = !historyVisible;
            const section = document.getElementById('historySection');
            if (historyVisible) {
                section.classList.remove('hidden');
            } else {
                section.classList.add('hidden');
            }
            updateHistory();
        }
        
        // Keyboard Event Handlers
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                hideAddMoney();
                hideAddCategory();
                hideExpenseModal();
            }
            
            if (e.key === 'Enter') {
                if (!document.getElementById('addMoneyModal').classList.contains('hidden')) {
                    addMoney();
                } else if (!document.getElementById('addCategoryModal').classList.contains('hidden')) {
                    createCategory();
                } else if (!document.getElementById('expenseModal').classList.contains('hidden')) {
                    logExpense();
                }
            }
        });
        
        // Click outside modal to close
        document.addEventListener('click', function(e) {
            if (e.target.classList.contains('modal-overlay')) {
                hideAddMoney();
                hideAddCategory();
                hideExpenseModal();
            }
        });
        
        // Initialize app when page loads
        document.addEventListener('DOMContentLoaded', init);
        
        // Handle app install prompt
        let deferredPrompt;
        
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            
            // Show install button or notification
            const installBtn = document.createElement('button');
            installBtn.textContent = 'Install App';
            installBtn.className = 'btn btn-primary';
            installBtn.style.position = 'fixed';
            installBtn.style.bottom = '20px';
            installBtn.style.right = '20px';
            installBtn.style.zIndex = '1001';
            
            installBtn.addEventListener('click', async () => {
                if (deferredPrompt) {
                    deferredPrompt.prompt();
                    const { outcome } = await deferredPrompt.userChoice;
                    deferredPrompt = null;
                    installBtn.remove();
                }
            });
            
            document.body.appendChild(installBtn);
            
            // Auto-hide after 10 seconds
            setTimeout(() => {
                if (installBtn.parentNode) {
                    installBtn.remove();
                }
            }, 10000);
        });
        
        // Handle app installed
        window.addEventListener('appinstalled', () => {
            console.log('PWA was installed');
        });
    </script>
</body>
</html>
        